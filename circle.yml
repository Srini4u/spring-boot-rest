machine:
  java:
    version: oraclejdk8
  services:
    - docker
    
  #environment:
    #TAG: $CIRCLE_BRANCH-$CIRCLE_BUILD_NUM
    #DOCKER_IMAGE: $DOCKER_USER/$DOCKER_REPO_APP:$TAG 

  test:
  override:
    - mvn  package install
    - docker info
    - docker build -t $DOCKER_USER/$DOCKER_REPO_APP:$CIRCLE_BRANCH-$CIRCLE_BUILD_NUM .
    
  deployment:
  hub:
    branch: master
    commands:
      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      - docker push $DOCKER_USER/$DOCKER_REPO_APP:$CIRCLE_BRANCH-$CIRCLE_BUILD_NUM
